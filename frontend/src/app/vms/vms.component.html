

<div *ngIf="loading && (user.chartevalidated || user.admin)">
    <div class="d-flex justify-content-center">
        <div class="spinner-border text-primary" role="status">
            <span class="sr-only">{{ "vms.loading" | translate}}</span>
        </div><br><br>
        
    </div>
</div>
<div class="alert alert-warning text-center" >
    <h5>{{"vm.alert.title" | translate}}</h5>
    <p>{{"vm.alert.descr.1" | translate}}</p><br>
    <p>{{"vm.alert.descr.2" | translate}}</p>
    <p>{{"vm.alert.descr.3" | translate}}</p>
    <p><a href='https://www.minet.net/fr/2022/10/29/incident.html'>{{"vm.alert.repair" | translate}}</a></p>
  </div>

<div class="alert alert-primary text-center" *ngIf="this.user.freezeState == 1">
    <h1>❄️</h1>
    <h4>Your account is frozen !</h4>
    <p>Your cotisation has expired ! You will still be able to manage your vm for few days. After 30 days of expiration your vm will be shutdown and after 60 days, they will be definitively destroyed</p>
    <p><strong>WARNING : you have only 30 days to renew your cotisation before the shutdown of your vm ! </strong></p>
</div>
<div class="alert alert-primary text-center" *ngIf="this.user.freezeState == 2">
    <h1>❄️</h1>
    <h4>Your account is frozen !</h4>
    <p>Your cotisation has expired since at least <strong>30 days !</strong> You will still be able to backup your vm for few days.  After 60 days (in less than 30 days now), they will be definitively destroyed</p>
    <p><strong>WARNING : you have only 30 days to renew your cotisation before the FULL DELETION of your vm ! </strong></p>
</div>
<div class="alert alert-primary text-center" *ngIf="this.user.freezeState == 3  ">
    <h1>❄️</h1>
    <h4>Your account is frozen !</h4>
    <p>Your cotisation has expired since at least <strong>60 days !</strong></p>
    <p><strong>WARNING : Your vm will be fully deleted in few days.</strong></p>
</div>
<div class="alert alert-warning text-center" *ngIf="this.user.freezeState == 3">
    <h4>Your cotisation has expired</h4>
    <p>Your cotisation has expired you cannot create any vm</p>
</div>

<div class="vms container flex-fill" *ngIf=" ((this.user.chartevalidated && this.user.freezeState < 3) || this.user.admin)" >

    <h1 class="text-center mb-2" *ngIf="!user.admin">My VMs</h1>
    <h1 class="text-center mb-2" *ngIf="user.admin">VMs List</h1>
    <div class="text-center"><button class="btn btn-primary" href="#" *ngIf="user.admin" [routerLink]="['/history']" [routerLinkActiveOptions]="{exact: true}"  [routerLinkActive]="['active', 'text-primary']">IP History</button></div>

    <ngb-pagination *ngIf="user.admin" [collectionSize]="totalVm" [pageSize]="pageSize" [(page)]="page"
                    aria-label="Default pagination" (pageChange)="loadPage()"></ngb-pagination>
    
    <h1 class="text-center mb-2" *ngIf="!user.admin">{{ "vms.listTitle" | translate}}</h1>
    <h1 class="text-center mb-2" *ngIf="user.admin">{{ "vms.listTitleAdmin" | translate}}</h1>
    <div class="text-center">
        <button class="btn btn-primary" href="#" *ngIf="user.admin" [routerLink]="['/history']" [routerLinkActiveOptions]="{exact: true}"  [routerLinkActive]="['active', 'text-primary']">{{ "vms.ipHistory" | translate}}</button>
        <br><br>
    </div>
    <div class="d-flex justify-content-around">
        <div *ngIf="user.admin">
        <div class="input-group">
            <br><br>
            <input type="search" class="form-control rounded" placeholder="Search" aria-label="Search" aria-describedby="search-addon" [(ngModel)]="this.searchFilter" />
            <button type="button" class="btn btn-outline-primary" (click)="get_vms()">search</button>
            <br>
        </div>
          </div>
          <div>
    <ngb-pagination *ngIf="user.admin" [collectionSize]="totalVm" [pageSize]="pageSize" [(page)]="page"
                    aria-label="Default pagination" (pageChange)="loadPage()">
                </ngb-pagination>
            </div>
    </div>
    <div class="text-center">
        
        <ng-container *ngIf="user.vms.length == 0 && !user.admin && !loading">
            <h4 class="text-danger">{{ "vms.noVms" | translate}}</h4>
        </ng-container>
        <ng-container *ngIf="user.vms.length == 0 && user.admin && !loading">
            <h4 class="text-danger">{{ "vms.noVmsAdmin" | translate}}</h4>
        </ng-container>
        <ng-container *ngIf="user.vms.length != 0 && !user.admin">
            <button *ngIf="!loading" class="btn btn-primary" (click)="scrollSsh(ssh)">{{ "vms.showSsh" | translate}}</button>
        </ng-container>
    </div>
    <hr>
    <div>
        <div class="comment" style="color:gray; font-style: italic;margin-bottom:10px;" *ngIf=" user.vms.length !=0 "><span>{{ "vms.refresh" | translate}}</span></div>
        <div class="row" *ngFor="let vm of user.vms | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize">
            
            <div class="col-12" >
                <div class="card border-success border-1" style="margin-bottom: 2%" >
                    <div class="card-img-top" *ngIf="!user.admin"
                         style='background-image: url("assets/images/vms/{{ vm.type }}.png"); height: 100px;
background-position: 50% 50%; background-size: 100%; position: relative'>
                        <small class="text-white m-2"
                               style="position: absolute; right: 0; bottom: 0">{{ vm.type | translate}}</small>
                    </div>
                    <div class="card-body">
                        <h4 class="card-title">
                            <div class="row">
                                <div class="col-6">
                                  <span class="badge badge-pill"
                                        [ngClass]="{
                                        'badge-danger': vm.status === 'stopped',
                                        'badge-info': vm.status === 'creating',
                                        'badge-warning': vm.status === 'booting',
                                        'badge-success': vm.status === 'running'
                                                }"
                                  >
                                      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"
                                            *ngIf="vm.status === 'booting'  || vm.status === 'creating' || loading"></span>{{ vm.status }}</span>
                                    &nbsp;{{ vm.name }}&nbsp;<small clallass="text-muted">(#{{ vm.id }})</small>&nbsp;<small *ngIf="user.admin" class="text-muted">- {{ vm.user }}</small>
                                    <br/>
                                    <br/>
                                    <p>{{ "vms.createdOn" | translate}} : {{vm.createdOn}}</p>

                                </div>
                                <div class="col-6">
                                    <div class="spinner-border text-primary" role="status" *ngIf="vm.createdOn == null">
                                        <span class="sr-only">{{ "vms.createdOn" | translate}}</span>
                                    </div>
                                    <p class="text-right">{{ vm.ip }}</p>
                                    <p class="text-right" *ngIf="vm.status == 'running'">{{ "vms.uptime" | translate}} : {{secondsToDhms(vm.uptime)}} </p>
                                </div>

                            </div>
                        </h4>
                        <a href="#" [routerLink]="[vm.id]" class="stretched-link"></a>

                    </div>
                </div>
            </div>
        </div>
        <div #ssh>
            <hr *ngIf="showSsh">
            <app-ssh *ngIf="showSsh"></app-ssh>
        </div>
    </div>
</div><br/>
<<<<<<< HEAD
<div class="alert alert-danger text-center" *ngIf="this.user.cotisation === 0">
    <b>{{'vms.subscription.expired_1' | translate}}</b>
    <p>{{'vms.subscription.expired_2' | translate}} <a href="https://payment.minet.net/">{{'vms.subscription.expired_3' | translate}}</a> {{'vms.subscription.expired_4' | translate}}</p>
</div>
<div class="alert alert-danger text-center" *ngIf="!this.user.chartevalidated && !user.admin && this.user.cotisation ===1">
    <b>{{'vms.charter.notsigned_1' | translate}}</b>
    <p>{{'vms.charter.notsigned_2' | translate}} <a href="https://chartes.minet.net/">{{'vms.charter.notsigned_3' | translate}}</a> {{'vms.charter.notsigned_4' | translate}}</p>
=======
<!--

<div class="alert alert-danger text-center" *ngIf="!this.user.chartevalidated && !user.admin && this.user.freezeState == 0">
    <b>Unsigned charter !</b>
    <p>To manage your VMs you have to sign the hosting charter ! <a href="https://chartes.minet.net/">click here</a> to sign the rules</p>
>>>>>>> 27d6f82 (Add the support of freezestatus by the frontend)
</div>
<ngb-pagination *ngIf="user.admin" [collectionSize]="totalVm" [pageSize]="pageSize" [(page)]="page"
                aria-label="Default pagination" (pageChange)="loadPage()"></ngb-pagination>
<hr>

-->